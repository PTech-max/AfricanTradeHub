<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Marketplace - AfricanTradeHub</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f0f4f8;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #0a3d62;
      color: white;
      padding: 20px;
      text-align: center;
    }

    .filters {
      background-color: #fff;
      padding: 15px 20px;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .filters select {
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      padding: 20px;
    }

    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .card h3 {
      margin-top: 0;
    }

    .card button {
      margin-top: 10px;
      background-color: #0a3d62;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
    }

    .card button:hover {
      background-color: #145a92;
    }
  </style>
</head>
<body>
  <header>
    <h1>Trade Marketplace</h1>
    <p>Find African businesses to partner with</p>
  </header>

  <div class="filters">
    <div>
      <label>Filter by Country:</label>
      <select>
        
      <option value="Angola">Angola</option>
      <option value="Benin">Benin</option>
      <option value="Botswana">Botswana</option>
      <option value="Burkina Faso">Burkina Faso</option>
      <option value="Burundi">Burundi</option>
      <option value="Cabo Verde">Cabo Verde</option>
      <option value="Cameroon">Cameroon</option>
      <option value="Central African Republic">Central African Republic</option>
      <option value="Chad">Chad</option>
      <option value="Comoros">Comoros</option>
      <option value="Congo">Congo</option>
      <option value="Côte d'Ivoire">Côte d'Ivoire</option>
      <option value="Democratic Republic of the Congo">Democratic Republic of the Congo</option>
      <option value="Djibouti">Djibouti</option>
      <option value="Egypt">Egypt</option>
      <option value="Equatorial Guinea">Equatorial Guinea</option>
      <option value="Eritrea">Eritrea</option>
      <option value="Eswatini">Eswatini</option>
      <option value="Ethiopia">Ethiopia</option>
      <option value="Gabon">Gabon</option>
      <option value="Gambia">Gambia</option>
      <option value="Ghana">Ghana</option>
      <option value="Guinea">Guinea</option>
      <option value="Guinea-Bissau">Guinea-Bissau</option>
      <option value="Kenya">Kenya</option>
      <option value="Lesotho">Lesotho</option>
      <option value="Liberia">Liberia</option>
      <option value="Libya">Libya</option>
      <option value="Madagascar">Madagascar</option>
      <option value="Malawi">Malawi</option>
      <option value="Mali">Mali</option>
      <option value="Mauritania">Mauritania</option>
      <option value="Mauritius">Mauritius</option>
      <option value="Morocco">Morocco</option>
      <option value="Mozambique">Mozambique</option>
      <option value="Namibia">Namibia</option>
      <option value="Niger">Niger</option>
      <option value="Nigeria">Nigeria</option>
      <option value="Rwanda">Rwanda</option>
      <option value="Sao Tome and Principe">Sao Tome and Principe</option>
      <option value="Senegal">Senegal</option>
      <option value="Seychelles">Seychelles</option>
      <option value="Sierra Leone">Sierra Leone</option>
      <option value="Somalia">Somalia</option>
      <option value="South Africa">South Africa</option>
      <option value="South Sudan">South Sudan</option>
      <option value="Sudan">Sudan</option>
      <option value="Tanzania">Tanzania</option>
      <option value="Togo">Togo</option>
      <option value="Tunisia">Tunisia</option>
      <option value="Uganda">Uganda</option>
      <option value="Zambia">Zambia</option>
      <option value="Zimbabwe">Zimbabwe</option>
      </select>
    </div>
    <div>
      <label>Filter by Business Type:</label>
      <select>
        <option value="">All Types</option>
        <option value="Manufacturer">Manufacturer</option>
        <option value="Wholesaler">Wholesaler</option>
        <option value="Retailer">Retailer</option>
        <option value="Exporter">Exporter</option>
      </select>

      <div class="grid" id="businessGrid"></div>

  <script>
async function loadCompanies() {
  const sel = document.getElementById("countrySelect");
  const country = sel ? sel.value : "all";
  const url = country && country !== "all"
    ? `/api/companies?country=${encodeURIComponent(country)}`
    : `/api/companies`;

  const grid = document.getElementById("businessGrid");
  grid.innerHTML = "Loading...";

  const resp = await fetch(url);
  const json = await resp.json();

  grid.innerHTML = "";
  if (!json.ok || !json.data.length) {
    grid.innerHTML = "<p>No businesses yet.</p>";
    return;
  }

  json.data.forEach(c => {
    const card = document.createElement("div");
    card.className = "business-card";
    card.innerHTML = `
      <img src="${c.logo_path || ''}" alt="Logo" onerror="this.style.display='none'">
      <h3>${c.business_name}</h3>
      <p><strong>Country:</strong> ${c.country}</p>
      <p><strong>Type:</strong> ${c.business_type}</p>
      <a href="mailto:${c.email}"><button>Contact</button></a>
    `;
    grid.appendChild(card);
  });
}

document.addEventListener("DOMContentLoaded", () => {
  const sel = document.getElementById("countrySelect");
  if (sel) sel.addEventListener("change", loadCompanies);
  loadCompanies();
});
</script>
</body>
</html>
